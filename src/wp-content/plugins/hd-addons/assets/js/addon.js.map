{"version":3,"file":"addon.js","sources":["../../resources/js/addon.js"],"sourcesContent":["import select2 from 'select2';\nimport 'select2/dist/css/select2.min.css';\nimport '../sass/3rd/_awesome-font.scss';\n\nselect2();\n\njQuery(function($) {\n    $('.addon-color-field').wpColorPicker();\n\n    //---------------------------------------------------------------\n    // codemirror\n    //---------------------------------------------------------------\n\n    if (typeof codemirror_settings !== 'undefined') {\n        const codemirror_css = document.querySelectorAll('.codemirror_css');\n        const codemirror_html = document.querySelectorAll('.codemirror_html');\n\n        function initializeCodeMirror(elements, settings, type) {\n            elements.forEach(el => {\n                if (!el.CodeMirror) {\n                    let editorSettings = settings ? { ...settings } : {};\n                    editorSettings.codemirror = {\n                        ...editorSettings.codemirror,\n                        indentUnit: 3,\n                        tabSize: 3,\n                        autoRefresh: true,\n                    };\n                    el.CodeMirror = wp.codeEditor.initialize(el, editorSettings);\n                }\n            });\n        }\n\n        initializeCodeMirror(codemirror_css, codemirror_settings.codemirror_css, 'CSS');\n        initializeCodeMirror(codemirror_html, codemirror_settings.codemirror_html, 'HTML');\n    }\n\n    //---------------------------------------------------------------\n    // Other\n    //---------------------------------------------------------------\n\n    $.fn.fadeOutAndRemove = function(speed) {\n        return this.fadeOut(speed, function() {\n            $(this).remove();\n        });\n    };\n\n    $.fn.serializeObject = function() {\n        let obj = {};\n        let array = this.serializeArray();\n        $.each(array, function() {\n            let name = this.name;\n            let value = this.value || '';\n            if (name.indexOf('[]') > -1) {\n                name = name.replace('[]', '');\n                if (!obj[name]) {\n                    obj[name] = [];\n                }\n                obj[name].push(value);\n            } else {\n                if (obj[name] !== undefined) {\n                    if (!Array.isArray(obj[name])) {\n                        obj[name] = [ obj[name] ];\n                    }\n                    obj[name].push(value);\n                } else {\n                    obj[name] = value;\n                }\n            }\n        });\n\n        return obj;\n    };\n\n    $(document).on('click', '.notice-dismiss', function(e) {\n        $(this).closest('.notice.is-dismissible')?.fadeOutAndRemove(500);\n    });\n\n    //---------------------------------------------------------------\n    // ajax submit settings\n    //---------------------------------------------------------------\n\n    $(document).on('submit', '#_settings_form', function(e) {\n        e.preventDefault();\n        let $this = $(this);\n        let $data = $this.serializeObject();\n\n        let btn_submit = $this.find('button[name=\"_submit_settings\"]');\n        let button_text = btn_submit.html();\n        let button_text_loading = '<span class=\"ajax-loader\">&nbsp;</span>';\n\n        btn_submit.prop('disabled', true).html(button_text_loading);\n        $.ajax({\n            type: 'POST',\n            url: ajaxurl,\n            data: {\n                action: 'submit_settings',\n                _data: $data,\n                _ajax_nonce: $this.find('input[name=\"_wpnonce\"]').val(),\n                _wp_http_referer: $this.find('input[name=\"_wp_http_referer\"]').val(),\n            },\n        })\n        .done(function(data) {\n            $this.find('#_content').prepend(data);\n\n            // auto reload tabs\n            if (!window.location.hash ||\n                window.location.hash === '#global_setting_settings' ||\n                window.location.hash === '#custom_css_settings' ||\n                window.location.hash === '#custom_script_settings' ||\n                (window.location.hash === '#custom_sorting_settings' && $data['order_reset'] !== undefined) ||\n                (window.location.hash === '#base_slug_settings' && $data['base_slug_reset'] !== undefined)\n            ) {\n                window.location.reload();\n            }\n\n            // dismissible auto hide\n            setTimeout(() => {\n                $this.find('#_content')?.find('.dismissible-auto')?.fadeOutAndRemove(400);\n            }, 4000);\n        })\n        .always(function () {\n            btn_submit.prop('disabled', false).html(button_text);\n        });\n    });\n\n    //---------------------------------------------------------------\n    // filter tabs\n    //---------------------------------------------------------------\n\n    const $filterTabs = $('.filter-tabs');\n    $filterTabs.each(function() {\n        const $el = $(this),\n            $nav = $el.find('.tabs-nav'),\n            $content = $el.find('.tabs-content'),\n            $tabs = $nav.find('a'),\n            initialHash = window.location.hash;\n\n        const activateTab = (hash) => {\n            const $tab = $nav.find(`a[href=\"${hash}\"]`);\n            $nav.find('a').removeClass('current');\n            $content.find('.tabs-panel').hide();\n\n            if ($tab.length) {\n                $tab.addClass('current');\n                $(hash).show();\n            } else {\n                $tabs.first().addClass('current');\n                $content.find('.tabs-panel').first().show();\n                window.history.replaceState(null, null, window.location.pathname + window.location.search);\n            }\n        };\n\n        activateTab(initialHash || $tabs.first().attr('href'));\n\n        $nav.on('click', 'a', function(e) {\n            e.preventDefault();\n            const hash = $(this).attr('href');\n            window.location.hash = hash;\n            activateTab(hash);\n            $('html, body').animate({ scrollTop: $el.offset().top - $('header').outerHeight() }, 300);\n        });\n\n        $(window).on('hashchange', function() {\n            activateTab(window.location.hash || $tabs.first().attr('href'));\n        });\n    });\n\n    //---------------------------------------------------------------\n    // select2\n    //---------------------------------------------------------------\n\n    // select2 multiple\n    const select2_multiple = $('.select2-multiple');\n    $.each(select2_multiple, function(i, el) {\n        $(el).select2({\n            multiple: true,\n            allowClear: true,\n            width: 'resolve',\n            dropdownAutoWidth: true,\n            placeholder: $(el).attr('placeholder'),\n        });\n    });\n\n    // select2 tags\n    const select2_tags = $('.select2-tags');\n    $.each(select2_tags, function(i, el) {\n        $(el).select2({\n            multiple: true,\n            tags: true,\n            allowClear: true,\n            width: 'resolve',\n            dropdownAutoWidth: true,\n            placeholder: $(el).attr('placeholder'),\n        });\n    });\n\n    // select2 IPs\n    const select2_ips = $('.select2-ips');\n    $.each(select2_ips, function(i, el) {\n        $(el).select2({\n            multiple: true,\n            tags: true,\n            allowClear: true,\n            width: 'resolve',\n            dropdownAutoWidth: true,\n            placeholder: $(el).attr('placeholder'),\n            createTag: function(params) {\n                let term = $.trim(params.term);\n\n                // Validate the term as an IP address or range\n                if (isValidIPRange(term)) {\n                    return {\n                        id: term,\n                        text: term,\n                    };\n                } else {\n                    return null;\n                }\n            },\n        });\n    });\n\n    // select2 emails\n    const select2_emails = $('.select2-emails');\n    $.each(select2_emails, function(i, el) {\n        $(el).select2({\n            multiple: true,\n            tags: true,\n            allowClear: true,\n            width: 'resolve',\n            dropdownAutoWidth: true,\n            placeholder: $(el).attr('placeholder'),\n            createTag: function(params) {\n                let term = $.trim(params.term);\n                if (isValidEmail(term)) {\n                    return {\n                        id: term,\n                        text: term,\n                    };\n                } else {\n                    return null;\n                }\n            },\n        });\n    });\n});\n\n/**\n * Validate email address\n *\n * @param {string} email\n * @returns {boolean}\n */\nfunction isValidEmail(email) {\n    const emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailPattern.test(email);\n}\n\n/**\n * validate IP range (IPv4)\n *\n * @param range\n * @returns {boolean}\n */\nfunction isValidIPRange(range) {\n    const ipPattern = /^(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})$/;\n    const rangePattern = /^(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})-(\\d|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])$/;\n    const cidrPattern = /^(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\.(25[0-5]|2[0-4]\\d|1\\d{2}|\\d{1,2})\\/(\\d|[1-2]\\d|3[0-2])$/;\n\n    if (ipPattern.test(range)) {\n        return true;\n    }\n\n    if (rangePattern.test(range)) {\n        const [ startIP, endRange ] = range.split('-');\n        const endIP = startIP.split('.').slice(0, 3).join('.') + '.' + endRange;\n        return compareIPs(startIP, endIP) < 0;\n    }\n\n    return cidrPattern.test(range);\n}\n\n/**\n * compare two IP addresses\n *\n * @param ip1\n * @param ip2\n * @returns {number}\n */\nfunction compareIPs(ip1, ip2) {\n    const ip1Parts = ip1.split('.').map(Number);\n    const ip2Parts = ip2.split('.').map(Number);\n\n    for (let i = 0; i < 4; i++) {\n        if (ip1Parts[i] < ip2Parts[i]) return -1;\n        if (ip1Parts[i] > ip2Parts[i]) return 1;\n    }\n    return 0;\n}\n"],"names":[],"mappings":"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"}